<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Search Page</title>
    <link rel="stylesheet" href="/Style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
          integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
</head>
<body>
<div th:replace="/headerFragment :: header"></div>
<div class="searchPage-Categories">
    <form th:action="@{/search_anime}" th:method="POST">
        <label>
            <p>Category</p>
            <input type="checkbox" name="category" value="action" >Action<br>
            <input type="checkbox" name="category" value="adventure" >Adventure<br>
            <input type="checkbox" name="category" value="comedy" >Comedy<br>
            <input type="checkbox" name="category" value="drama" >Drama<br>
            <input type="checkbox" name="category" value="fantasy" >Fantasy<br>
            <input type="checkbox" name="category" value="horror" >Horror<br>
            <input type="hidden" name="category" value="default" required>
        </label>
        <button th:type="submit">Search Anime</button>
    </form>
</div>
<div class="searchPage-Container">
    <div class="searchPage-SearchedAnime" th:unless="${searchedAnime.isEmpty()}" th:each="anime : ${searchedAnime}">
        <h2 th:if="${anime.titleEng() != null}" th:text="${anime.titleEng()}">Loading..</h2>
        <img th:if="${anime.posterImage() != null}" th:src="${anime.posterImage}" alt="Poster Image" onclick="submitForm(this)">
        <form th:action="@{/rate_anime}" th:method="POST" id="animeForm">
            <input type="hidden" th:value="${anime.posterImage()}" th:name="posterImage">
            <input type="hidden" th:value="${anime.titleEng()}" th:name="titleEng">
            <input type="hidden" th:value="${anime.titleJP()}" th:name="titleJP">
            <input type="hidden" th:value="${anime.description()}" th:name="description">
            <input type="hidden" th:value="${anime.episodes()}" th:name="episodes">
        </form>
    </div>
</div>
<script>
    function submitForm(clickedImage) {
            const form = clickedImage.closest('div').querySelector('form');
            form.submit();
        }
</script>
</body>
</html>